{
  "bsonType": "object",
  "required": ["pickup_code", "food_list", "total_price", "status", "create_time"],
  "permission": {
    "read": true,
    "create": true,
    "update": true,
    "delete": false
  },
  "properties": {
    "_id": {
      "description": "文档ID，系统自动生成",
      "bsonType": "string"
    },
    "order_no": {
      "bsonType": "string",
      "title": "订单编号",
      "description": "系统生成的订单编号",
      "pattern": "^ORD[0-9]{15}$",
      "label": "订单编号"
    },
    "table_number": {
      "bsonType": "string",
      "title": "桌号",
      "description": "顾客所在的桌号",
      "minLength": 1,
      "maxLength": 20,
      "label": "桌号"
    },
    "pickup_code": {
      "bsonType": "string",
      "title": "取餐码",
      "description": "4-6位取餐识别码",
      "minLength": 4,
      "maxLength": 6,
      "defaultValue": "0000",
      "label": "取餐码"
    },
    "food_list": {
      "bsonType": "array",
      "title": "菜品清单",
      "description": "订单中的菜品列表",
      "minItems": 1,
      "items": {
        "bsonType": "object",
        "required": ["food_id", "name", "price", "quantity"],
        "properties": {
          "food_id": {
            "bsonType": "string",
            "foreignKey": "food._id",
            "label": "菜品ID"
          },
          "name": {
            "bsonType": "string",
            "minLength": 1,
            "maxLength": 50,
            "label": "菜品名称"
          },
          "price": {
            "bsonType": "double",
            "minimum": 0,
            "maximum": 999,
            "label": "单价"
          },
          "quantity": {
            "bsonType": "int",
            "minimum": 1,
            "maximum": 99,
            "label": "数量"
          },
          "specs": {
            "bsonType": "string",
            "title": "规格信息",
            "description": "JSON字符串格式的规格信息",
            "maxLength": 200,
            "label": "规格"
          },
          "image": {
            "bsonType": "string",
            "title": "菜品图片",
            "format": "url",
            "label": "图片URL"
          }
        }
      },
      "label": "菜品清单"
    },
    "total_price": {
      "bsonType": "double",
      "title": "订单总价",
      "minimum": 0,
      "maximum": 9999,
      "label": "总金额"
    },
    "status": {
      "bsonType": "string",
      "title": "订单状态",
      "enum": ["待支付",
      "已支付",
      "制作中",
      "待取餐", 
      "已完成",
      "已取消",
	  "失败"],
      "defaultValue": "待支付",
      "label": "状态"
    },
    "contact_info": {
      "bsonType": "object",
      "title": "联系信息",
      "required": ["name"],
      "properties": {
        "name": {
          "bsonType": "string",
          "minLength": 2,
          "maxLength": 10,
          "label": "顾客姓名"
        },
        "phone": {
          "bsonType": "string",
          "pattern": "^1[3-9]\\d{9}$",
          "label": "联系电话"
        },
        "user_id": {
          "bsonType": "string",
          "description": "关联用户ID",
          "label": "用户ID"
        }
      },
      "label": "联系信息"
    },
    "remark": {
      "bsonType": "string",
      "title": "订单备注",
      "maxLength": 200,
      "label": "备注"
    },
    "create_time": {
      "bsonType": "timestamp",
      "title": "创建时间",
      "label": "创建时间"
    },
    "pay_time": {
      "bsonType": "timestamp",
      "title": "支付时间",
      "label": "支付时间"
    },
    "wx_transaction_id": {
      "bsonType": "string",
      "title": "微信交易号",
      "maxLength": 32,
      "label": "微信单号"
    },
    "payment_method": {
      "bsonType": "string",
      "title": "支付方式",
      "enum": ["wechat", "alipay", "cash", "other"],
	  "defaultValue": "wechat",
      "label": "支付方式"
    }
  }
}